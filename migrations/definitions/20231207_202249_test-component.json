{"schemas":"--- original\n+++ modified\n@@ -3,6 +3,12 @@\n DEFINE FIELD reference ON component TYPE string;\n DEFINE FIELD configuration ON component FLEXIBLE TYPE object;\n DEFINE FIELD priority ON component TYPE int DEFAULT 1 ASSERT $value >= 1 && $value <= 4;\n+DEFINE TABLE controls SCHEMAFULL;\n+\n+DEFINE FIELD in ON TABLE controls TYPE record<component>;\n+DEFINE FIELD out ON TABLE controls TYPE record<device>;\n+\n+DEFINE INDEX unique_controls ON TABLE controls COLUMNS in, out UNIQUE;\n DEFINE TABLE device SCHEMAFULL;\n\n DEFINE FIELD name ON device TYPE string;\n@@ -11,13 +17,13 @@\n DEFINE FIELD manufacturer ON device TYPE string;\n DEFINE FIELD sw_version ON device TYPE option<string>;\n DEFINE FIELD hw_version ON device TYPE option<string>;\n-DEFINE TABLE entity SCHEMALESS;\n+DEFINE TABLE entity SCHEMAFULL;\n\n DEFINE FIELD state ON entity TYPE string;\n DEFINE FIELD enabled ON entity TYPE bool DEFAULT true;\n DEFINE FIELD available ON entity TYPE bool DEFAULT true;\n DEFINE FIELD class ON entity TYPE string;\n-DEFINE FIELD attributes ON entity TYPE object;\n+DEFINE FIELD attributes ON entity TYPE option<object>;\n\n -- DEFINE EVENT state_changed ON TABLE entity WHEN $before.state != $after.state THEN ();\n DEFINE TABLE script_migration SCHEMAFULL\n@@ -26,4 +32,12 @@\n         FOR create, update, delete NONE;\n\n DEFINE FIELD script_name ON script_migration TYPE string;\n-DEFINE FIELD executed_at ON script_migration TYPE datetime DEFAULT time::now();\n\\ No newline at end of file\n+DEFINE FIELD executed_at ON script_migration TYPE datetime DEFAULT time::now();\n+DEFINE TABLE updates SCHEMAFULL;\n+\n+DEFINE FIELD in ON TABLE updates TYPE record<device> ASSERT $value != NONE;\n+DEFINE FIELD out ON TABLE updates TYPE record<entity> ASSERT $value != NONE;\n+DEFINE FIELD with_polling ON TABLE updates TYPE bool DEFAULT true ASSERT $value != NONE;\n+DEFINE FIELD polling_interval ON TABLE updates TYPE number DEFAULT 120 ASSERT $value > 0;\n+\n+DEFINE INDEX unique_updates ON TABLE updates COLUMNS in, out UNIQUE;\n\\ No newline at end of file\n","events":null}